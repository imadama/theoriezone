# TheorieZone – Exam Mode spec (MVP)

Datum: 2026-01-26  
Status: concept v1

Doel: een examensimulatie die zo dicht mogelijk bij “echt examen” aanvoelt en **exam integrity** afdwingt.

---

## 1) Terminologie
- **ExamAttempt**: een poging van een leerling voor een examen.
- **State**: status van de poging.
- **Interruption**: gebeurtenis die exam integrity breekt (bv. tab switch, app background, refresh, disconnect > X sec).

---

## 2) ExamAttempt states (state machine)

### Staten
- `DRAFT` – examen is aangemaakt maar nog niet gestart.
- `CONFIRM_PENDING` – leerling ziet bevestiging (startknop).
- `IN_PROGRESS` – examen loopt.
- `SUBMITTED` – leerling heeft ingestuurd.
- `TERMINATED` – examen beëindigd door onderbreking/regel.
- `EXPIRED` – tijdslimiet verstreken.

### Regels
- R1: Een examen gaat pas naar `IN_PROGRESS` na expliciete bevestiging door leerling.
- R2: Vanuit `IN_PROGRESS` leidt een **Interruption** direct naar `TERMINATED`.
- R3: `TERMINATED` en `EXPIRED` tellen als **poging**.
- R4: Resultaten van `SUBMITTED/EXPIRED/TERMINATED` zijn **definitief**.
- R5: Alleen Operationeel Beheerder kan een poging resetten (zie §6).

> Dit lost de schijn-tegenstrijdigheid op uit het doc: “altijd afgerond” = elke poging eindigt altijd in een eindstatus (SUBMITTED/EXPIRED/TERMINATED).

---

## 3) Wat is een “Interruption” (MVP definitie)

### Web (browser)
Interruption events:
- I1: Tab/window blur + focus weg > 0s (direct) *(streng)*
- I2: Page refresh/reload
- I3: Close tab/window
- I4: Navigatie weg van exam page (back, URL change)
- I5: Network disconnect langer dan `X` seconden (MVP voorstel: X=10s)

### Mobile (later / optioneel)
- App naar background
- Screen lock

Acceptatiecriteria:
- AC-E1: Als I1–I5 gebeurt tijdens `IN_PROGRESS`, status wordt `TERMINATED` en poging telt.
- AC-E2: UI toont duidelijke melding: “Examen beëindigd door onderbreking. Dit telt als poging.”

---

## 4) Exam configuratie (MVP)

Per tenant (default via platform):
- aantal vragen (bijv. 50)
- tijdslimiet (bijv. 30 min)
- cesuur (bijv. ≥ 44/50)
- herkanstermijn (optioneel later)

Acceptatiecriteria:
- AC-C1: Tenant admin kan exam config zien (edit later, of read-only in MVP).

---

## 5) Resultaten & review

MVP output per attempt:
- score (#goed/#totaal)
- status (geslaagd/gezakt) gebaseerd op cesuur
- reason (alleen bij TERMINATED: type interruption)

Optie (kies):
- Review fout/goed na afloop (aan/uit per tenant)

Acceptatiecriteria:
- AC-R1: Resultaat is direct zichtbaar na SUBMITTED/EXPIRED/TERMINATED.
- AC-R2: Instructeur ziet attempt historie van leerling (met timestamps en status).

---

## 6) Reset policy (Operationeel beheer)

Alleen Operationeel Beheerder:
- kan attempt “resetten” (markeren als niet-tellend) **alleen bij aantoonbare storing**.
- moet altijd reden invullen.
- audit log entry verplicht.

Acceptatiecriteria:
- AC-X1: Reset kan niet door instructeur/tenant admin.
- AC-X2: Elke reset heeft: who/when/why + referentie naar incident.

---

## 7) UX copy (MVP)

Voor start:
- “Je examen start pas na bevestiging. Tijdens het examen mag je de pagina niet verlaten. Elke onderbreking beëindigt het examen en telt als poging.”

Bij beëindiging:
- “Examen beëindigd door onderbreking: <reason>. Dit telt als poging.”
